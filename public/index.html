<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="theme-color" content="#000000">
    <title>Reactable</title>
    <style type='text/css'>
      .reactable table td, .reactable table th {font-family: monospace;}
    </style>
  </head>
  <body>
    <button onClick="addData()">ADD DATA</button>

    <div id="table1"></div>
    <br /><br />
    <hr>
    <label for='multisearch'>Search by first name or email</label>
    <input type="search" id='multisearch' onInput="multisearch(['first_name', 'email'], this.value)">
    <div id="table2"></div>
    <hr>
    <script src="../dist/reactable-bundle.js"></script>
    <script src='./schema.js'></script>
    <script src='./actions.js'></script>
    <script>
      function fetchData(url, table) {
        fetch(url)
          .then(function(response) {
            return response.json()
          })
          .then(function(json) {
            table.addData(json.data, 200);
          })
      }

      var t1 = Reactable.init({
        htmlId:   "table1",
        schema:   schemaUsers,
        actions:  actionsUser,
        offset:   2,
        controlShow: false
      });

      var data = [{"id":1,"first_name":"Mikaela","last_name":"Monahan","email":"hermine@kilback.com","website":"dubuque.name","ip":"20.250.175.124","gender":"female","date_of_birth":"1997-12-29","active":true,"phone_number":"02944 1267073","currency":"TRY","job":"Human Web Manager","duration":"PT2H3M56S","created_at":"2016-10-17T01:26:55+01:00"},{"id":2,"first_name":"Joe","last_name":"Doyle","email":"bobbie@ruecker.com","website":"gislason.name","ip":"181.211.95.208","gender":"female","date_of_birth":null,"active":true,"phone_number":"099 4907253","currency":"FKP","job":"Senior Identity Engineer","duration":null,"created_at":"2016-06-24T01:26:55+01:00"},{"id":3,"first_name":"Rubye","last_name":"D'Amore","email":"carl.reichel@mcglynn.name","website":"thompson.ca","ip":"158.172.29.101","gender":null,"date_of_birth":"2000-09-21","active":false,"phone_number":"05196 5477441","currency":"MAD","job":"Chief Group Representative","duration":"P2DT22H4M50S","created_at":"2017-01-05T01:26:55+01:00"},{"id":4,"first_name":"Nam","last_name":"Auer","email":"","website":"cronin.biz","ip":"52.86.182.30","gender":"female","date_of_birth":"1986-05-02","active":null,"phone_number":"072 3651186","currency":"KGS","job":"Corporate Program Facilitator","duration":null,"created_at":"2017-04-06T01:26:55+01:00"},{"id":5,"first_name":"Domitila","last_name":"Schmeler","email":"jenell_ebert@roberts.biz","website":"gorczany.name","ip":"193.227.243.26","gender":"female","date_of_birth":"1983-04-21","active":true,"phone_number":"0249 3388401","currency":"BSD","job":"District Paradigm Producer","duration":"PT2H3M56S","created_at":"2017-06-16T01:26:55+01:00"},{"id":6,"first_name":"Madeline","last_name":"Murray","email":"wanda_hickle@dooley.com","website":"schummrobel.ca","ip":"6.123.153.80","gender":"male","date_of_birth":"1998-11-11","active":true,"phone_number":"074 0251460","currency":"KYD","job":"Senior Response Agent","duration":"PT2H3M56S","created_at":"2016-06-27T01:26:55+01:00"},{"id":7,"first_name":"Angila","last_name":"Leffler","email":null,"website":"brekkeward.com","ip":"19.197.44.229","gender":"female","date_of_birth":"1992-02-04","active":false,"phone_number":"048 8757437","currency":"MOP","job":"International Data Strategist","duration":"P2DT22H4M50S","created_at":"2018-06-02T01:26:55+01:00"},{"id":8,"first_name":"Trish","last_name":"Bode","email":null,"website":"balistreri.name","ip":"240.222.187.139","gender":null,"date_of_birth":"1996-02-29","active":null,"phone_number":"0393 4175975","currency":"WST","job":"Legacy Creative Director","duration":null,"created_at":"2016-04-12T01:26:55+01:00"},{"id":9,"first_name":"George","last_name":"Bartell","email":"violeta@murphyrunolfsdottir.us","website":"block.name","ip":"20.106.48.41","gender":"male","date_of_birth":"2016-09-24","active":true,"phone_number":"0993 2542303","currency":"ETB","job":"Lead Program Strategist","duration":"P2DT22H4M50S","created_at":"2016-06-23T01:26:55+01:00"},{"id":10,"first_name":"Man","last_name":"Rodriguez","email":null,"website":"streich.us","ip":"69.113.243.187","gender":null,"date_of_birth":"1999-04-22","active":false,"phone_number":"082 4783525","currency":"KYD","job":"Chief Data Associate","duration":"PT2H3M56S","created_at":"2016-06-25T01:26:55+01:00"}]

      t1.render();
      t1.updateTableWidth(document.getElementById('table1').clientWidth)


      function addData() {
        t1.addData(data);
      }

      var t2 = Reactable.init({
        htmlId:   "table2",
        schema: schemaUsers,
        strategySearch: 'and',
        limit: 15,
        controls: {
          csv: {
            onClick: function (e) { console.log('Download CSV', e)},
            className: '',
            key: 'csv',
            disabled: false,
            label: 'CSV',
          }
        },
        afterRender: function () { defaultSearch() },
        itemsChange: function (items) { itemsChange(items) },
      });

      fetchData("./data-100.json", t2)
      t2.render();
      t2.updateTableWidth(document.getElementById('table2').clientWidth)

      function itemsChange(items) {
        console.log("Filtered Items callback: ", items)
      }

      function defaultSearch() {
        // t2.searchAND({gender: {value: 'male', options: 'equal'}, active: { value: 'true'}});
      }

      function multisearch(columns, value) {
        var query = {}
        columns.forEach((c) => query[c] = { value: value} )
        t2.searchOR(query)
      }

    </script>
  </body>
</html>
